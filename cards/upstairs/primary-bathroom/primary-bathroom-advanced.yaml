type: vertical-stack
cards:
  - type: custom:bubble-card
    card_type: pop-up
    hash: "#primary-bathroom-advanced"
    button_type: name
    width_desktop: 75vw
    show_header: true
    name: Return to Overview
    show_icon: true
    icon: mdi:arrow-left
    show_name: true
    margin: 7px
    scrolling_effect: false
    sub_button:
      main: []
      bottom:
        - name: Back
          icon: mdi:arrow-left
          show_name: true
          show_icon: true
          tap_action:
            action: navigate
            navigation_path: "#primary-bathroom-history"
    tap_action:
      action: navigate
      navigation_path: "#primary-bathroom-history"
    button_action:
      tap_action:
        action: navigate
        navigation_path: "#primary-bathroom-history"

  - type: markdown
    content: |
      ## Primary Bathroom - Sensors

  - type: markdown
    content: |
      ### Room behavior

      - **Vanity**: occupancy-based.
      - **Shower / Fan Light / Group**: **manual** (no auto-on).
      - **Single press** on the **Shower** switch toggles the **Fan Light**.
      - When any **non-vanity** light has been turned on, the **Lights Off** automation uses the **Shower Off Delay** (long delay) until the room turns off.

  - type: custom:bubble-card
    card_type: sub-buttons
    show_header_toggle: false
    sub_button:
      main: []
      bottom:
        - name: Lux
          buttons_layout: inline
          group:
            - entity: sensor.upstairs_primary_bath_vanity_inovelli_presence_illuminance
              name: Vanity Lux
              icon: mdi:brightness-6
              show_name: true
              show_state: true
              show_icon: true
              content_layout: icon-top
              custom_height: 60
            - entity: sensor.upstairs_primary_bath_shower_inovelli_presence_illuminance
              name: Shower Lux
              icon: mdi:brightness-6
              show_name: true
              show_state: true
              show_icon: true
              content_layout: icon-top
              custom_height: 60
        - name: Power
          buttons_layout: inline
          group:
            - entity: sensor.upstairs_primary_bath_vanity_inovelli_presence_power
              name: Vanity Power
              icon: mdi:flash
              show_name: true
              show_state: true
              show_icon: true
              content_layout: icon-top
              custom_height: 60
            - entity: sensor.upstairs_primary_bath_shower_inovelli_presence_power
              name: Shower Power
              icon: mdi:flash
              show_name: true
              show_state: true
              show_icon: true
              content_layout: icon-top
              custom_height: 60
        - name: State
          buttons_layout: inline
          group:
            - entity: sensor.upstairs_primary_bath_vanity_inovelli_presence_overheat
              name: Vanity Overheat
              icon: mdi:thermometer-alert
              show_name: true
              show_state: true
              show_icon: true
              content_layout: icon-top
              custom_height: 60
            - entity: sensor.upstairs_primary_bath_shower_inovelli_presence_overheat
              name: Shower Overheat
              icon: mdi:thermometer-alert
              show_name: true
              show_state: true
              show_icon: true
              content_layout: icon-top
              custom_height: 60
        - name: Night Light
          buttons_layout: inline
          group:
            - entity: sensor.upstairs_primary_bath_night_light_illuminance
              name: Night Light Lux
              icon: mdi:brightness-6
              show_name: true
              show_state: true
              show_icon: true
              content_layout: icon-top
              custom_height: 60
      bottom_layout: rows
    rows: 4.5

  - type: markdown
    content: |
      ## Inovelli Parameters

  - type: custom:bubble-card
    card_type: sub-buttons
    show_header_toggle: false
    sub_button:
      main: []
      bottom:
        - name: Vanity mmWave — Detection
          buttons_layout: inline
          group:
            - entity: select.upstairs_primary_bath_vanity_inovelli_presence_mmwavedetectsensitivity
              sub_button_type: select
              name: Sensitivity
              icon: mdi:radar
              show_name: false
              show_state: true
              content_layout: icon-left
              custom_height: 60
            - entity: select.upstairs_primary_bath_vanity_inovelli_presence_mmwavedetecttrigger
              sub_button_type: select
              name: Trigger Delay
              icon: mdi:timer-outline
              show_name: false
              show_state: true
              content_layout: icon-left
              custom_height: 60
        - name: Vanity Switch Modes
          buttons_layout: inline
          group:
            - entity: select.upstairs_primary_bath_vanity_inovelli_presence_outputmode
              icon: mdi:light-switch
              show_icon: true
              show_state: true
              show_name: false
              content_layout: icon-left
              custom_height: 60
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              sub_button_type: default
            - entity: select.upstairs_primary_bath_vanity_inovelli_presence_smartbulbmode
              icon: mdi:lightbulb-outline
              show_icon: true
              show_state: true
              show_name: false
              content_layout: icon-left
              custom_height: 60
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              sub_button_type: default
        - name: Shower mmWave — Detection
          buttons_layout: inline
          group:
            - entity: select.upstairs_primary_bath_shower_inovelli_presence_mmwavedetectsensitivity
              sub_button_type: select
              name: Sensitivity
              icon: mdi:radar
              show_name: false
              show_state: true
              content_layout: icon-left
              custom_height: 60
            - entity: select.upstairs_primary_bath_shower_inovelli_presence_mmwavedetecttrigger
              sub_button_type: select
              name: Trigger Delay
              icon: mdi:timer-outline
              show_name: false
              show_state: true
              content_layout: icon-left
              custom_height: 60
        - name: Shower Switch Modes
          buttons_layout: inline
          group:
            - entity: select.upstairs_primary_bath_shower_inovelli_presence_outputmode
              icon: mdi:light-switch
              show_icon: true
              show_state: true
              show_name: false
              content_layout: icon-left
              custom_height: 60
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              sub_button_type: default
            - entity: select.upstairs_primary_bath_shower_inovelli_presence_smartbulbmode
              icon: mdi:lightbulb-outline
              show_icon: true
              show_state: true
              show_name: false
              content_layout: icon-left
              custom_height: 60
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              sub_button_type: default
      bottom_layout: rows
    rows: 4.5

  - type: markdown
    content: |
      #### Vanity mmWave Clear Timing
  - type: grid
    columns: 2
    square: false
    cards:
      - type: markdown
        content: >-
          **MmWave Hold Time**


          How long the **load stays ON** after the switch stops detecting
          presence.

          Value is in **seconds** (e.g. **5 = 5s**). Default is **10s**.
      - type: markdown
        content: >-
          **MmWave Stay Life**


          How long the “stay” area lingers after motion stops (affects how
          quickly the switch reports **cleared**).

          Default is **300** (≈15s). Lower values can be sub-second
          (e.g. **1 ≈ 50ms**, **20 ≈ 1s**).
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwaveholdtime
        name: Hold Time (s)
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
        features_position: inline
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwavestaylife
        name: Stay Life
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
        features_position: inline
      - type: entities
        entities:
          - entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwaveholdtime
            name: Hold Time (s)
      - type: entities
        entities:
          - entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwavestaylife
            name: Stay Life

  - type: markdown
    content: |
      #### Vanity - mmWave Trigger Boundary (cm)
  - type: grid
    columns: 2
    square: false
    cards:
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwavedepthmin
        name: Depth Min
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwavedepthmax
        name: Depth Max
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwavewidthmin
        name: Width Left
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwavewidthmax
        name: Width Right
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwaveheightmin
        name: Height Floor
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_vanity_inovelli_presence_mmwaveheightmax
        name: Height Ceiling
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom

  - type: markdown
    content: >-
      **MQTT Commands**    <small>

      Last command: {% set s =
      states('sensor.upstairs_primary_bath_vanity_inovelli_presence_mmwave_control_commands')
      %} {{ s if s not in ['unknown','unavailable',''] else '—' }} </small>

  - type: custom:bubble-card
    card_type: sub-buttons
    show_header_toggle: false
    sub_button:
      main: []
      bottom:
        - name: Vanity mmWave Commands
          buttons_layout: inline
          group:
            - name: Set Interference
              icon: mdi:shield-outline
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_vanity_inovelli_presence
                  command: set_interference
            - name: Clear Interference
              icon: mdi:shield-off-outline
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_vanity_inovelli_presence
                  command: clear_interference
            - name: Reset Area
              icon: mdi:crop-free
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_vanity_inovelli_presence
                  command: reset_detection_area
            - name: Reset Module
              icon: mdi:restart-alert
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_vanity_inovelli_presence
                  command: reset_mmwave_module
      bottom_layout: inline
    rows: 1.625
    modules:
      - my_module

  - type: markdown
    content: |
      #### Shower mmWave Clear Timing
  - type: grid
    columns: 2
    square: false
    cards:
      - type: markdown
        content: >-
          **MmWave Hold Time**


          How long the **load stays ON** after the switch stops detecting
          presence.

          Value is in **seconds** (e.g. **5 = 5s**). Default is **10s**.
      - type: markdown
        content: >-
          **MmWave Stay Life**


          How long the “stay” area lingers after motion stops (affects how
          quickly the switch reports **cleared**).

          Default is **300** (≈15s). Lower values can be sub-second
          (e.g. **1 ≈ 50ms**, **20 ≈ 1s**).
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwaveholdtime
        name: Hold Time (s)
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
        features_position: inline
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwavestaylife
        name: Stay Life
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
        features_position: inline
      - type: entities
        entities:
          - entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwaveholdtime
            name: Hold Time (s)
      - type: entities
        entities:
          - entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwavestaylife
            name: Stay Life

  - type: markdown
    content: |
      #### Shower - mmWave Trigger Boundary (cm)
  - type: grid
    columns: 2
    square: false
    cards:
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwavedepthmin
        name: Depth Min
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwavedepthmax
        name: Depth Max
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwavewidthmin
        name: Width Left
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwavewidthmax
        name: Width Right
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwaveheightmin
        name: Height Floor
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom
      - type: tile
        entity: number.upstairs_primary_bath_shower_inovelli_presence_mmwaveheightmax
        name: Height Ceiling
        vertical: false
        hide_state: true
        tap_action:
          action: none
        hold_action:
          action: more-info
        features:
          - type: numeric-input
            style: buttons
          - type: numeric-input
        features_position: bottom

  - type: markdown
    content: >-
      **MQTT Commands**    <small>

      Last command: {% set s =
      states('sensor.upstairs_primary_bath_shower_inovelli_presence_mmwave_control_commands')
      %} {{ s if s not in ['unknown','unavailable',''] else '—' }} </small>

  - type: custom:bubble-card
    card_type: sub-buttons
    show_header_toggle: false
    sub_button:
      main: []
      bottom:
        - name: Shower mmWave Commands
          buttons_layout: inline
          group:
            - name: Set Interference
              icon: mdi:shield-outline
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_shower_inovelli_presence
                  command: set_interference
            - name: Clear Interference
              icon: mdi:shield-off-outline
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_shower_inovelli_presence
                  command: clear_interference
            - name: Reset Area
              icon: mdi:crop-free
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_shower_inovelli_presence
                  command: reset_detection_area
            - name: Reset Module
              icon: mdi:restart-alert
              show_state: false
              show_name: true
              content_layout: icon-top
              custom_height: 80
              tap_action:
                action: perform-action
                perform_action: script.inovelli_mmwave_control
                target: {}
                data:
                  device: upstairs_primary_bath_shower_inovelli_presence
                  command: reset_mmwave_module
      bottom_layout: inline
    rows: 1.625
    modules:
      - my_module